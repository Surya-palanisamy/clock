<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title> Timer Challenge</title>
  <style>
    :root{
      --bg1:#0f172a;
      --bg2:#0b1220;
      --card:#0b1020;
      --accent:#7c3aed;
      --muted:#94a3b8;
      --danger:#ff4d4f;
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{height:100%}
    body{
      font-family:Inter,ui-sans-serif,system-ui,Arial,\"Helvetica Neue\",Helvetica,sans-serif;
      background:linear-gradient(135deg,var(--bg1),var(--bg2));
      color:#e6eef8;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
    }

    /* Subtle animated radial glow */
    .scene{
      width:100%;
      max-width:900px;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .card{
      width:100%;
      background:linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.015));
      border-radius:18px;
      padding:28px;
      box-shadow:0 10px 30px rgba(2,6,23,0.7), inset 0 1px 0 rgba(255,255,255,0.02);
      border:1px solid rgba(124,58,237,0.12);
      backdrop-filter: blur(6px);
    }

    .header{
      display:flex;
      gap:16px;
      align-items:center;
      margin-bottom:10px;
    }

    .logo{
      width:56px;height:56px;border-radius:12px;
      display:grid;place-items:center;font-weight:700;font-size:20px;
      background:linear-gradient(135deg,var(--accent),#06b6d4);
      color:white;box-shadow:0 6px 20px rgba(124,58,237,0.18);
    }

    h2{font-size:20px;letter-spacing:0.2px}
    p.lead{color:var(--muted);font-size:14px;margin-top:6px}

    .timer-wrap{
      display:flex;flex-direction:column;align-items:center;justify-content:center;
      padding:30px 18px;margin-top:18px;border-radius:12px;background:rgba(255,255,255,0.02);
      border:1px solid rgba(255,255,255,0.02);
    }

    #timer{
      font-size:40px;font-weight:700;letter-spacing:0.5px;text-align:center;
      padding:6px 12px;margin-bottom:8px;
    }

    #detected{
      color:var(--danger);font-weight:700;display:none;margin-top:6px;text-align:center;
      background:rgba(255,77,79,0.08);padding:8px 12px;border-radius:8px;border:1px solid rgba(255,77,79,0.12);
    }

    .meta{
      display:flex;gap:12px;align-items:center;justify-content:center;margin-top:8px;color:var(--muted);font-size:13px
    }

    /* Responsive tweaks */
    @media (max-width:520px){
      .card{padding:18px;border-radius:12px}
      #timer{font-size:28px}
      .logo{width:48px;height:48px;font-size:18px}
    }

  </style>
</head>
<body>
  <div class="scene">
    <div class="card" role="main" aria-labelledby="title">
      <div class="header">
        <div class="logo">HA</div>
        <div>
          <h2 id="title">⏳ Timer Challenge</h2>
          <p class="lead">A mysterious countdown hides a secret — be clever, not hasty.</p>
        </div>
      </div>

      <div class="timer-wrap" aria-live="polite">
        <p id="timer">Loading…</p>
      </div>
    </div>
  </div>

  <script>
    // 30 days + 3 hours from now
    let endTime = Date.now() + (30 * 24 * 60 * 60 * 1000) + (3 * 60 * 60 * 1000);

    // exact flag requested (only stored in cookie)
    const FLAG = "rontOrOVERPh";

    function setCookie(name, value, days) {
      let d = new Date();
      d.setTime(d.getTime() + (days * 24 * 60 * 60 * 1000));
      let expires = "expires=" + d.toUTCString();
      // encodeURIComponent is safe; FLAG contains only safe characters so it will remain identical
      document.cookie = name + "=" + encodeURIComponent(value) + ";" + expires + ";path=/";
    }

    function updateTimer() {
      let now = Date.now();
      let diff = endTime - now;

      if (diff <= 0) {
        document.getElementById("timer").textContent = "✅ Timer Finished!";
        // set cookie only (no localStorage)
        setCookie("CTF_Flag", FLAG, 1); // cookie will contain: rontOrOVERPh
      } else {
        let days = Math.floor(diff / (1000 * 60 * 60 * 24));
        let hours = Math.floor((diff % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
        let minutes = Math.floor((diff % (1000 * 60 * 60)) / (1000 * 60));
        let seconds = Math.floor((diff % (1000 * 60)) / 1000);

        // keep the same logic; use a proper template string so the timer renders correctly
        document.getElementById("timer").textContent = `${days}d ${hours}h ${minutes}m ${seconds}s remaining...`;
      }
    }
    setInterval(updateTimer, 1000);
    updateTimer();

    window.addEventListener("keydown", function (e) {
      // F12
      if (e.key === "F12" || e.keyCode === 123) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }

      if (e.ctrlKey && e.shiftKey && (e.key === 'I' || e.key === 'i' || e.key === 'J' || e.key === 'j' || e.key === 'C' || e.key === 'c')) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }

      if (e.ctrlKey && (e.key === 'U' || e.key === 'u' || e.key === 'S' || e.key === 's')) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }

      if (e.ctrlKey && e.shiftKey && (e.key === 'K' || e.key === 'k')) {
        e.preventDefault();
        e.stopPropagation();
        return false;
      }
    }, true);

    // Block right-click context menu
    window.addEventListener('contextmenu', function (e) {
      e.preventDefault();
    }, true);

    let devtoolsOpen = false;
    const threshold = 160;

    function detectDevTools() {
      const widthDiff = window.outerWidth - window.innerWidth;
      const heightDiff = window.outerHeight - window.innerHeight;
      if (widthDiff > threshold || heightDiff > threshold) {
        if (!devtoolsOpen) {
          devtoolsOpen = true;
          onDevToolsDetected();
        }
      } else {
        if (devtoolsOpen) {
          devtoolsOpen = false;
          onDevToolsClosed();
        }
      }
    }

    function onDevToolsDetected() {
      const el = document.getElementById('detected');
      if (el) el.style.display = 'block';
      console.warn('DevTools suspected open — limited functionality applied.');
    }

    function onDevToolsClosed() {
      const el = document.getElementById('detected');
      if (el) el.style.display = 'none';
      console.log('DevTools closed (or heuristics say so).');
    }

    // Check periodically
    setInterval(detectDevTools, 1000);

    (function () {
      const start = Date.now();
      debugger;
      const took = Date.now() - start;
      if (took > 100) {
        onDevToolsDetected();
      }
    })();
  </script>
</body>
</html>
